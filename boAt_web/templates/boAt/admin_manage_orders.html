{% extends 'static_pages/base.html' %}
{% load static %}

{% block start %}
<link rel="stylesheet" href="{% static 'css/sale_is_live.css' %}">
<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}">

<div class="container-fluid">
  <div class="dashboard-wrapper">

    <!-- Sidebar (20%) -->
    {% include 'boAt/sidebar.html' %}

    <!-- Content (80%) -->
    <div class="main-content p-4">
      <div class="btndiv d-flex justify-content-between" style="height:40px; margin-bottom:25px;">
        <h2 class="mb-4">All Orders</h2>
        <a href="{% url 'admin_dashboard' %}" class="btn btn-success">Back to dashboard</a>
      </div>

      <table class="table table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th class="text-center">Order ID</th>
            <th>User</th>
            <th>Status</th>
            <th>Total</th>
            <th>Placed On</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for order in orders %}
          <tr>
            <td class="text-center">#{{ order.id }}</td>
            <td>{{ order.user.username }}</td>
            <td>
              <span class="badge
                {% if order.status == 'pending' %}bg-warning
                {% elif order.status == 'processing' %}bg-info
                {% elif order.status == 'shipped' %}bg-primary
                {% elif order.status == 'delivered' %}bg-success
                {% endif %}
              ">
                {{ order.status|title }}
              </span>
            </td>
            <td>â‚¹{{ order.total }}</td>
            <td>{{ order.created_at|date:"M d, Y H:i" }}</td>
            <td>
              <form method="POST" action="{% url 'update_status' order.id %}">
                {% csrf_token %}
                <select name="status" class="form-select form-select-sm" onchange="this.form.submit()">
                  {% for value, label in order.STATUS_CHOICES %}
                    <option value="{{ value }}" {% if order.status == value %}selected{% endif %}>
                      {{ label }}
                    </option>
                  {% endfor %}
                </select>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="6" class="text-center">No orders yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
