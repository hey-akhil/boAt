{% extends 'static_pages/base.html' %}
{% load static %}
{% block start %}
<link rel="stylesheet" href="{% static 'css/sale_is_live.css' %}">

<body class="p-4">
  <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mt-4 mb-4">
          <h2 class="mb-0">Manage Products</h2>
          <a href="{% url 'add_product' %}" class="btn btn-success">Add Product</a>
      </div>

    <!-- Filter Buttons -->
    <div class="d-flex flex-wrap gap-3 mb-4 category-tabs">
      <button class="tab-button active" data-category="all">All Deals</button>
      <button class="tab-button" data-category="earbuds">True Wireless Earbuds</button>
      <button class="tab-button" data-category="smartwatch">Smartwatches</button>
      <button class="tab-button" data-category="speaker">Speakers And Soundbars</button>
      <button class="tab-button" data-category="neckband">Neckbands And Headphones</button>
    </div>

    <!-- Product Table -->
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Image</th>
          <th>Title</th>
          <th>Badge</th>
          <th>Playback</th>
          <th>Rating</th>
          <th>Price</th>
          <th>Old Price</th>
          <th>Discount</th>
          <th colspan="2" class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody id="productTable">
        {% for product in products %}
        <tr class="product-item" data-title="{{ product.title|lower }}">
          <td>{{ forloop.counter }}</td>
          <td>
            {% if product.image %}
              <img src="{{ product.image.url }}" class="img-thumbnail" style="width: 100px; height: 100px;">
            {% endif %}
          </td>
          <td>{{ product.title }}</td>
          <td>{{ product.badge }}</td>
          <td>{{ product.playback_badge }}</td>
          <td>{{ product.rating }}</td>
          <td>₹{{ product.price }}</td>
          <td>₹{{ product.old_price }}</td>
          <td>{{ product.discount }}</td>
          <td>
            <a href="{% url 'edit_product' product.pk %}" class="btn btn-sm btn-primary">Edit</a>
          </td>
          <td>
            <a href="{% url 'delete_product' product.pk %}" class="btn btn-sm btn-danger"
               onclick="return confirm('Are you sure you want to delete this product?');">Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="10" class="text-center">No products found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <script src="{% static 'js/view_product2.js' %}"></script>

  {% if messages %}
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      {% for message in messages %}
      Swal.fire({
        icon: 'success',
        title: '{{ message }}',
        showConfirmButton: false,
        timer: 2000
      });
      {% endfor %}
    </script>
  {% endif %}
{% endblock %}
